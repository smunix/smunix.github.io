<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<!-- Mirrored from cdsmith.wordpress.com/2009/04/20/code-for-manipulating-graphs-in-haskell/?replytocom=1058 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Dec 2016 21:59:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Code for Manipulating Graphs in Haskell | Sententia cdsmithus</title>
<meta name="copyright" content="Design is copyright 2009 - 2016 The Theme Foundry" />
<!--[if lte IE 7]>
<script type="text/javascript">
	sfHover=function(){var sfEls=document.getElementById("navigation").getElementsByTagName("LI");for(var i=0;i<sfEls.length;i++){sfEls[i].onmouseover=function(){this.className+=" sfhover";}
	sfEls[i].onmouseout=function(){this.className=this.className.replace(new RegExp(" sfhover\\b"),"");}}}
	if (window.attachEvent)window.attachEvent("onload",sfHover);
</script>
<![endif]-->
<!--[if IE 6]>
<link rel="stylesheet" type="text/css" media="screen" href="https://s0.wp.com/wp-content/themes/pub/paperpunch/stylesheets/ie6.css" />
<script type="text/javascript" src="https://s0.wp.com/wp-content/themes/pub/paperpunch/javascripts/pngfix.js"></script>
<script type="text/javascript"> DD_belatedPNG.fix( '#navigation, div.comments a' );</script>
<![endif]-->
<link rel="pingback" href="https://cdsmith.wordpress.com/xmlrpc.php" />
<link rel='dns-prefetch' href='http://s2.wp.com/' />
<link rel='dns-prefetch' href='http://s1.wp.com/' />
<link rel='dns-prefetch' href='http://s0.wp.com/' />
<link rel="alternate" type="application/rss+xml" title="Sententia cdsmithus &raquo; Feed" href="https://cdsmith.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sententia cdsmithus &raquo; Comments Feed" href="https://cdsmith.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sententia cdsmithus &raquo; Code for Manipulating Graphs in&nbsp;Haskell Comments Feed" href="feed/index.html" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1473172720h&ver=4.6.1-RC1-38499"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkN0OwiAMRl9IRI1zemF8FmB1Q/lpaHHZ28s0mkXN4g1pyTnwtbJHYWJgCCx9FuhyawNJZ69A8gKMylzFo1saooWc4NrF9i30MTWqIdm6qJX7j0WFkDAH04nb5kuZpEngFEMjMBJ/dHOaDWcbLA+SO/BlHMx68uecaWKCcu9R8Uh4aKwCVx4JPKd53L2ssezK7mYD9lhooTUmIBLl9DZ78Uz75f0cQhIPDkb25I/rbVXXm1W1P1zung2w2w==' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='paperpunch-ie-css'  href='https://s0.wp.com/wp-content/themes/pub/paperpunch/stylesheets/ie.css?m=1274890335h&#038;ver=4.6.1-RC1-38499' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='all-css-2-1' href='https://s2.wp.com/_static/??-eJx9i8sKgCAQAH8oWwSjOkTfYmLLhrrig34/u0Rdus3ADBAELmQ45Ad6k3MHZxRNig0FfBXRVaTWoGXh2OhCHD4idqcp/a3Jbo6xIUKrXnpPq1+kGmalplGq4wKxyTcd' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3-1' href='https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-4-1' href='https://s0.wp.com/_static/??-eJx9i0EKQjEMBS9kDUpRuxDPkl9qG0mT0uTj9cWFiCiu3jyYgfsIWcWLOPQ1DF4riQFmJ5UF55u22WwDv/Wh5uHKSBOs4SSpr/1XmWZCDqxVP89X5K30YtAiVNYF+Slc+nkXjynt0ykebg/FyknH' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFj+sKwjAMhV/IrHib+kN8ltrFkdqbTevQpzcD/aEOhUDIyZfDiRoSUDCudsjKSl0q5tuzNZZn6hcAnvqsCzaewgs2MRQMZWR9PJJDqIxZ96KJ0SlOcCly8cgs0MT2PRKFK+HwF7NYkjZnyMh0/3L1FZKrPQVWGZ080MGY4WOSq4Pfz1dtu14sd5utfQAruHB+'></script>
<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621h' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://cdsmith.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Re: Conditional Convergence, or when Addition Isn&#8217;t&nbsp;Commutative' href='https://cdsmith.wordpress.com/2009/04/19/re-conditional-convergence-or-when-addition-isnt-commutative/' />
<link rel='next' title='Old Memories About Trisecting&nbsp;Angles' href='https://cdsmith.wordpress.com/2009/04/20/old-memories-about-trisecting-angles/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='http://wp.me/p4RkZ-15' />
<meta name='robots' content='noindex,follow' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=https%3A%2F%2Fcdsmith.wordpress.com%2F2009%2F04%2F20%2Fcode-for-manipulating-graphs-in-haskell%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=https%3A%2F%2Fcdsmith.wordpress.com%2F2009%2F04%2F20%2Fcode-for-manipulating-graphs-in-haskell%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Code for Manipulating Graphs in Haskell" />
<meta property="og:url" content="https://cdsmith.wordpress.com/2009/04/20/code-for-manipulating-graphs-in-haskell/" />
<meta property="og:description" content="Here&#8217;s a bunch of code I wrote, most of it about a year ago, for doing things with the graphs from the Data.Graph module in Haskell.  The choice of functions, from among the many generally us…" />
<meta property="article:published_time" content="2009-04-20T23:48:45+00:00" />
<meta property="article:modified_time" content="2009-04-20T23:48:45+00:00" />
<meta property="og:site_name" content="Sententia cdsmithus" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:card" content="summary" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://cdsmith.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://cdsmith.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://cdsmith.wordpress.com/osd.xml" title="Sententia cdsmithus" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Sententia cdsmithus" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="software, programming languages, and other ideas" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://cdsmith.wordpress.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="title" content="Code for Manipulating Graphs in&nbsp;Haskell | Sententia cdsmithus on WordPress.com" />
<meta name="description" content="Here&#039;s a bunch of code I wrote, most of it about a year ago, for doing things with the graphs from the Data.Graph module in Haskell.  The choice of functions, from among the many generally useful functions acting on graphs, comes from a specific project.  The actually functionality is pretty generic, though.  So I&#039;m just&hellip;" />
		<script type="text/javascript" src="http://c.amazon-adsystem.com/aax2/amzn_ads.js"></script>
		<script type="text/javascript">
		try { amznads.getAds("3033"); } catch(e) { /* ignore */ }
		</script>
		<script type="text/javascript">
		try {
			var a9_p = amznads.getKeys(),
			_ipw_custom = {
				wordAds: '0',
				adSafe: '1',
				domain: 'cdsmith.wordpress.com',
				pageURL: 'https://cdsmith.wordpress.com/2009/04/20/code-for-manipulating-graphs-in-haskell/'
			};
			if("undefined"!=typeof a9_p&&""!=a9_p&&null!==a9_p&&"[object Array]"===Object.prototype.toString.call(a9_p)){var a="",b=0,c=a9_p.length;a9_p.sort();for(var d=0;d<c;d++){a9_p[d-b]=a9_p[d-b].replace(/a1x6p/,"a160x600p");var e=a9_p[d-b].split("p");e[0]==a&&(a9_p.splice(d-b,1),b++);a=e[0]}_ipw_custom.amznPay=a9_p};document.close();
		} catch(e) {}
		</script> 		<script type="text/javascript" src="https://static.criteo.net/js/ld/publishertag.js"></script>
 		<script type="text/javascript" src="http://s.pubmine.com/head.js"></script>
		<script type="text/javascript">
		jQuery(window).ready(function () {
			jQuery("a.wpa-about").text("About these ads");
		});
		</script><link rel="amphtml" href="amp/index.html" /><style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script>
</head>
<body class="single single-post postid-67 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light">
	<div id="wrapper">
		<div class="skip-content"><a href="#content">Skip to content</a></div>
	<div id="header" class="clear">
		<ul id="follow">
			<li>
				<a href="https://cdsmith.wordpress.com/feed/"><img src="https://s0.wp.com/wp-content/themes/pub/paperpunch/images/flw-rss.png" alt="RSS Feed"/></a>
			</li>
		</ul>
		<div id="title"><a href="https://cdsmith.wordpress.com/">Sententia cdsmithus</a></div>		<div id="description">software, programming languages, and other ideas</div>
		</div><!--end header-->

		<div id="navigation" class="clear">
				<ul class="menu">
			</ul>
		</div><!--end navigation -->

	<div id="content">
				<div class="post-box">
			<div id="post-67" class="post-67 post type-post status-publish format-standard hentry category-uncategorized">
				<div class="meta clear">
					<div class="author">April 20, 2009 <span>/ cdsmith</span></div>
				</div><!--end meta-->
				<div class="post-header">
				 <h1>Code for Manipulating Graphs in&nbsp;Haskell</h1>
				 				</div><!--end post header-->
				<div class="entry clear">
										<p>Here&#8217;s a bunch of code I wrote, most of it about a year ago, for doing things with the graphs from the Data.Graph module in Haskell.  The choice of functions, from among the many generally useful functions acting on graphs, comes from a specific project.  The actually functionality is pretty generic, though.  So I&#8217;m just throwing this out there.  If someone else wanted to package it and throw it on Hackage (likely with a different module name), they would be welcome to do so.</p>
<p><span id="more-67"></span></p>
<blockquote>
<pre>
{-
    Module containing utility functions for operating on Data.Graph.
-}
module GraphUtil where

import Data.Graph
import Data.List
import Data.Tree
import Data.Array
import Data.Maybe
import Data.Function (on)
import qualified Data.Map as M
import Data.Map (Map)

{-
    Computes all possible (directed) graphs over n vertices.  Allows
    loops and antiparallel edges, but does not allow parallel edges.
-}
allGraphs n = map (buildG (1,n))
                  (subsequences [ (a,b) | a &lt;- [1..n], b &lt;- [1..n] ])

{-
    Finds all cycles in a graph.  A cycle is given as a finite list of
    the vertices in order of occurrence, where each vertex only appears
    once.

    The point where the cycle is broken to form a linear list is arbitrary, so
    each cycle is merely one representative of the equivalence class
    generated by the relation identifying (v:vs) with vs++[v].  In
    particular, this function chooses the representative with the lowest
    numbered starting vertex.
-}
cycles g = concatMap cycles' (vertices g)
    where cycles' v   = build [] v v
          build p s v =
            let p'         = p ++ [v]
                local      = [ p' | x &lt;- (g!v), x == s ]
                good w     = w &gt; s &amp;&amp; not (w `elem` p')
                ws         = filter good (g ! v)
                extensions = concatMap (build p' s) ws
            in  local ++ extensions

{-
    Computes a table of the number of loops at each vertex.
-}
loopdegree g = array (bounds g) [ (v, count v (g!v)) | v &lt;- vertices g]
    where count v [] = 0
          count v (x:xs) | x == v    = 1 + count v xs
                         | otherwise = count v xs

{-
    Tests two graphs to see if they are isomorphic.  This is a worst-case
    exponential algorithm, but should perform acceptably in practice on
    small graphs.  It uses backtracking, associating vertices one by one
    until it either finds a complete isomorphism, or reaches a vertex
    that can't be matched with a remaining vertex in the other graph.
-}
isIsomorphic g1 g2 = let v1   = vertices g1
                         v2   = vertices g2
                     in  (length v1 == length v2) &amp;&amp; test [] v1 v2

    where {-
            Takes the first vertex v of g1, looks for vertices w of g2
            that work "so far", and tries to construct an isomorphism
            that maps v to w.
          -}
          test m []     [] = True
          test m (v:vs) ws =
            let cs = filter (similar m v) ws
            in  any (\w -&gt; test ((v,w):m) vs (delete w ws)) cs

          {-
            Tests whether a given mapping v -&gt; w for v in g1, w in g2
            works "so far".  In order for the mapping to work, the
            vertices must agree on their in-degree, out-degree, and
            number of loops; and already mapped adjacent vertices via
            in- and out-edges must correspond.
          -}
          similar m v w    =    (in1   ! v) == (in2   ! w)
                             &amp;&amp; (out1  ! v) == (out2  ! w)
                             &amp;&amp; (loop1 ! v) == (loop2 ! w)
                             &amp;&amp; match ((v,w):m) (g1 !v) (g2 !w)
                             &amp;&amp; match ((v,w):m) (g1'!v) (g2'!w)

          {-
            Tests whether a list of vertices agrees in those edges that
            are already mapped to each other via the association list m.
          -}
          match m vs ws =
            let kvs = mapMaybe (\v -&gt; find ((== v) . fst) m) vs
                kws = mapMaybe (\w -&gt; find ((== w) . snd) m) ws
            in  sort kvs == sort kws

          {-
            Some global information about the graphs that can be
            calculated only once to save time.  This includes the
            degrees and number of loops at each vertex, and the
            transpose of the graphs (used to find in-edges).
          -}
          g1'   = transposeG g1
          g2'   = transposeG g2
          in1   = outdegree  g1'
          out1  = outdegree  g1
          in2   = outdegree  g2'
          out2  = outdegree  g2
          loop1 = loopdegree g1
          loop2 = loopdegree g2

{-
    Returns the degree sequence of a given graph.  The degree sequence is
    a sorted sequence of tuples representing the in-degree, out-degree,
    and loop-degree, respectively, of each vertex in the graph.  The
    degree sequence has the desirable properties that it is:

        (a) a graph property (that is, invariant under isomorphism)

        (b) relatively cheap to compute, and

        (c) classifies non-isomorphic graphs very effectively into small
            groups.
-}
degsequence g = sort (zip3 (elems (indegree g))
                           (elems (outdegree g))
                           (elems (loopdegree g)))

{-
    Given a list of graphs, removes the duplicates up to isomorphism.

    The implementation takes advantage of the fact that the degree
    sequence is the same for any pair of isomorphic graphs.  Therefore,
    the process maintains a map from degree sequences found so far to
    their respective graphs.  This removes the need to compare most sets
    of graphs in a normal list.  If the list contains only graphs with
    the same degree sequence, then this function will be very slow, as
    it will perform O(n^2) isomorphism tests, each of which are worst-case
    exponential.
-}
isonub :: [Graph] -&gt; [Graph]
isonub gs = go M.empty gs
    where go hs []     = []
          go hs (g:gs) =
            let dseq = degsequence g
                poss = M.findWithDefault [] dseq hs
            in  if any (isIsomorphic g) poss
                    then     go hs                          gs
                    else g : go (M.insert dseq (g:poss) hs) gs

{-
    Finds the shortest paths from the given vertex to any other vertex
    of the graph.  The paths returned are lists of vertices, so if there
    are parallel edges in the graph, each result may actually correspond
    to multiple paths.

    The algorithm is essentially breadth first search, but done in bulk
    for each increase in depth, ensuring that all shortest paths are
    found for each vertex.
-}
shortestPaths g v = go (M.singleton v [[v]]) [v]
    where go ans []  = M.map (map reverse) ans
          go ans ws  = let new  = map (step ans) ws
                           next = foldl (M.unionWith (++)) ans new
                       in  go next (M.keys next \\ M.keys ans)
          step ans w = let new   = filter (not . (`M.member` ans)) (g!w)
                           soFar = ans M.! w
                           paths = map (\x -&gt; map (x:) soFar) new
                       in  M.fromList (zip new paths)

{-
    Computes all possible directed subforests of a given graph.  A
    subforest is a subgraph with the property that there is at most one
    edge entering any vertex.

    The approach is to first choose the set of vertices, which may be
    any subset of the vertices of the given graph, and then choose the
    edge (if any) entering each vertex.  Parallel edges are ignored,
    since they would lead to isomorphic subforests.
-}
subforests :: Graph -&gt; [Graph]
subforests g = filter ((== []) . cycles)
                $ concatMap subsAt
                $ subsequences (vertices g)
    where g'        = transposeG g
          subsAt vs = let vmap      = zip vs [1..]
                          tr v      = fromJust (lookup v vmap)
                          tre (v,w) = (tr v, tr w)
                          inAt v    = filter (`elem` vs) $ nub $ (g' ! v)
                      in  [ buildG (1, length vs) fixedEdges
                                | edges &lt;- [ [] : [ [(w,v)] | w &lt;- inAt v ] | v &lt;- vs ],
                                  let fixedEdges = map tre (concat edges) ]
</pre>
</blockquote>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<a class="wpa-about" href="https://wordpress.com/about-these-ads/" rel="nofollow"></a>
				        <div id="crt-1708420137" style="width:300px;height:250px;"></div>
        <script type="text/javascript">
        var o = document.getElementById('crt-1708420137');
        if ("undefined"!=typeof Criteo) {
            var p = o.parentNode;
            p.style.setProperty('display', 'inline-block', 'important');
            o.style.setProperty('display', 'block', 'important');
            Criteo.DisplayAcceptableAdIfAdblocked({zoneid:388248,containerid:"crt-1708420137",collapseContainerIfNotAdblocked:true});
        } else {
            o.style.setProperty('display', 'none', 'important');
        }
        </script>
				<div class="u">
					<script type='text/javascript'>
					(function(g){if("undefined"!=typeof g.__ATA){g.__ATA.initAd({sectionId:26942, width:300, height:250});}})(window);
					</script>
				</div>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-reddit"><a rel="nofollow" data-shared="" class="share-reddit sd-button share-icon" href="index1ea5.html?share=reddit" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-67" class="share-twitter sd-button share-icon" href="index9a7b.html?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-67" class="share-facebook sd-button share-icon" href="index5a58.html?share=facebook" target="_blank" title="Share on Facebook"><span>Facebook</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-67" class="share-google-plus-1 sd-button share-icon" href="index386f.html?share=google-plus-1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-1158345-67-585706939a543' data-src='//widgets.wp.com/likes/#blog_id=1158345&amp;post_id=67&amp;origin=cdsmith.wordpress.com&amp;obj_id=1158345-67-585706939a543' data-name='like-post-frame-1158345-67-585706939a543'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>														</div><!--end entry-->
				<div class="post-footer clear">
										<div class="category">Filed under <a href="https://cdsmith.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a></div>
				</div><!--end post footer-->
			</div><!--end post-->
		</div><!--end post-box-->
		<div class="pagination post single clear">
			<div class="alignleft"><a href="https://cdsmith.wordpress.com/2009/04/19/re-conditional-convergence-or-when-addition-isnt-commutative/" rel="prev">&larr; Re: Conditional Convergence, or when Addition Isn&#8217;t&nbsp;Commutative</a></div>
			<div class="alignright" ><a href="https://cdsmith.wordpress.com/2009/04/20/old-memories-about-trisecting-angles/" rel="next">Old Memories About Trisecting&nbsp;Angles &rarr;</a></div>
		</div><!--end pagination-->
			<!-- You can start editing here. -->
<div id="comments">
	<div class="comment-number">
		<h4>5 Comments</h4>
					<span><a href="#respond" title="Leave a Comment">Leave a Comment</a></span>
			</div><!--end comment-number-->
			<ol class="commentlist">
			
	<li class="comment even thread-even depth-1 highlander-comment" id="comment-1055" >
		<div class="comment-box clear">
			<div class="c-head clear ">
				<a href='http://ivanmiljenovic.wordpress.com/' rel='external nofollow' class='url'>Ivan Miljenovic</a> <span>/ Apr 21 2009 6:32 pm</span>
			</div>
			<div class="c-grav"><img alt='' src='https://2.gravatar.com/avatar/82401038e87257529066b9e6618d470e?s=32&amp;d=identicon&amp;r=G' class='avatar avatar-32' height='32' width='32' /></div>
			<div class="c-body">
								<p>Would you know how your isIsomorphic and isonub functions compare to Jean-Philippe Bernardy&#8217;s HGAL package (available via Hackage)?  And how do you define &#8220;small&#8221; graphs?  (I&#8217;m needing to remove isomorphic duplicates from potentially millions of graphs of various orders&#8230;)</p>
								<div class="reply">
					<a rel='nofollow' class='comment-reply-link' href='indexcc4c.html?replytocom=1055#respond' onclick='return addComment.moveForm( "comment-1055", "1055", "respond", "67" )' aria-label='Reply to Ivan Miljenovic'>Reply</a>				</div>
							</div><!--end c-body-->
		</div><!--end comment-box-->
</li><!-- #comment-## -->

	<li class="comment byuser comment-author-cdsmith bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-1056" >
		<div class="comment-box clear">
			<div class="c-head clear admin-comment">
				cdsmith <span>/ Apr 21 2009 6:58 pm</span>
			</div>
			<div class="c-grav"><img alt='' src='https://1.gravatar.com/avatar/1e7f8859add1bf7ddd9b5fe9000b6a68?s=32&amp;d=identicon&amp;r=G' class='avatar avatar-32' height='32' width='32' /></div>
			<div class="c-body">
								<p>I have little doubt that the HGAL implementation of isIsomorphic is considerably faster in most cases, though you could give it a shot.  I don&#8217;t see anything like isonub in the hgal package, though if I understand correctly, you could map canonicGraph from the Data.Graph.Automorphism package over the list, and then just sort the list and remove consecutive duplicates using the standard Ord and Eq instances.</p>
<p>I was unable to get hgal installed quickly when I wrote this (and again now, I get errors from cabal install, related to building an old version of the array package)&#8230; and since my application only had to deal with tens of thousands of graphs of at most about 5 vertices, this worked just as well.</p>
								<div class="reply">
					<a rel='nofollow' class='comment-reply-link' href='indexc358.html?replytocom=1056#respond' onclick='return addComment.moveForm( "comment-1056", "1056", "respond", "67" )' aria-label='Reply to cdsmith'>Reply</a>				</div>
							</div><!--end c-body-->
		</div><!--end comment-box-->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="comment-1057" >
		<div class="comment-box clear">
			<div class="c-head clear ">
				<a href='http://ivanmiljenovic.wordpress.com/' rel='external nofollow' class='url'>Ivan Miljenovic</a> <span>/ Apr 21 2009 7:12 pm</span>
			</div>
			<div class="c-grav"><img alt='' src='https://2.gravatar.com/avatar/82401038e87257529066b9e6618d470e?s=32&amp;d=identicon&amp;r=G' class='avatar avatar-32' height='32' width='32' /></div>
			<div class="c-body">
								<p>I&#8217;ve been using HGAL basically by doing &#8220;map fst . nubBy ((==) `on` snd) . map (\f -&gt; (f,canonicGraph . toGraph f))&#8221; (where toGraph is function on my data type I&#8217;m using).  I&#8217;m probably going to try re-implementing HGAL on my own directly from Brendan McKay&#8217;s paper to see if I can improve performance somehow, as my app spends more time doing canonicGraph than anything else :s</p>
								<div class="reply">
					<a rel='nofollow' class='comment-reply-link' href='indexeb1e.html?replytocom=1057#respond' onclick='return addComment.moveForm( "comment-1057", "1057", "respond", "67" )' aria-label='Reply to Ivan Miljenovic'>Reply</a>				</div>
							</div><!--end c-body-->
		</div><!--end comment-box-->
</li><!-- #comment-## -->

	<li class="comment byuser comment-author-cdsmith bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-1058" >
		<div class="comment-box clear">
			<div class="c-head clear admin-comment">
				cdsmith <span>/ Apr 22 2009 4:00 pm</span>
			</div>
			<div class="c-grav"><img alt='' src='https://1.gravatar.com/avatar/1e7f8859add1bf7ddd9b5fe9000b6a68?s=32&amp;d=identicon&amp;r=G' class='avatar avatar-32' height='32' width='32' /></div>
			<div class="c-body">
								<p>Ivan, if you have a large enough number of graphs, using nubBy is unwise.  You&#8217;re actually better off sorting (Graph is an instance of Ord), and then removing consecutive duplicates. (map head . groupBy ((==) `on` snd . sort) would replace your nubBy in that case.</p>
								<div class="reply">
					<a rel='nofollow' class='comment-reply-link' href='index7ce1.html?replytocom=1058#respond' onclick='return addComment.moveForm( "comment-1058", "1058", "respond", "67" )' aria-label='Reply to cdsmith'>Reply</a>				</div>
							</div><!--end c-body-->
		</div><!--end comment-box-->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="comment-1059" >
		<div class="comment-box clear">
			<div class="c-head clear ">
				<a href='http://ivanmiljenovic.wordpress.com/' rel='external nofollow' class='url'>Ivan Miljenovic</a> <span>/ Apr 22 2009 4:33 pm</span>
			</div>
			<div class="c-grav"><img alt='' src='https://2.gravatar.com/avatar/82401038e87257529066b9e6618d470e?s=32&amp;d=identicon&amp;r=G' class='avatar avatar-32' height='32' width='32' /></div>
			<div class="c-body">
								<p>Actually, I&#8217;m using a Set to store the current canonical graphs found, after much urging by the people on #haskell.</p>
<p>Even so, however, I beg to differ that nubBy is unwise: about 2/3 of my time is spent running canonicGraph (which I do _before_ removing duplicates).  Considering that for one test I ran, I had over 2.5 million values out of which only around 140 were unique, nubBy isn&#8217;t that much of a problem.</p>
<p>The big advantage of nubBy as opposed to using &#8220;map head . group . sort&#8221; or &#8220;Set.toList . Set.fromList&#8221; is that nubBy is _lazy_, so that my program can start spitting out values as soon as it finds them as opposed to having to sort the entire list (which gets _very_ large) before it can start printing values.</p>
								<div class="reply">
					<a rel='nofollow' class='comment-reply-link' href='index78d5.html?replytocom=1059#respond' onclick='return addComment.moveForm( "comment-1059", "1059", "respond", "67" )' aria-label='Reply to Ivan Miljenovic'>Reply</a>				</div>
							</div><!--end c-body-->
		</div><!--end comment-box-->
</li><!-- #comment-## -->
		</ol>
		<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
		</div><!--end comments-->


				<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply to <a href="#comment-1058">cdsmith</a> <small><a rel="nofollow" id="cancel-comment-reply-link" href="index.html#respond">Cancel reply</a></small></h3>				<form action="https://cdsmith.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="9d055970d2" /><input type="hidden" name="_wp_http_referer" value="/2009/04/20/code-for-manipulating-graphs-in-haskell/?replytocom=1058" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=https%3A%2F%2Fcdsmith.wordpress.com" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name</label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url" value="" /></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="WordPress.com Logo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" />
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google+ photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p></div>




<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='67' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='1058' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="db33aa78f8" /></p>
<input type="hidden" name="genseq" value="1482098323" />
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="200"/></p>				</form>
					</div><!-- #respond -->
		<div style="clear: both"></div>
	</div><!--end content-->
<div id="sidebar">
	<ul>
				<li id="recent-posts-3" class="widget widget_recent_entries">		<h2 class="widgettitle">Recent Posts</h2>		<ul>
					<li>
				<a href="https://cdsmith.wordpress.com/2016/06/30/codeworld-for-younger-ages/">CodeWorld for Younger&nbsp;Ages!</a>
						</li>
					<li>
				<a href="https://cdsmith.wordpress.com/2016/05/22/codeworlds-big-decisions/">CodeWorld&#8217;s Big Decisions</a>
						</li>
					<li>
				<a href="https://cdsmith.wordpress.com/2016/05/06/reminder-summer-of-haskell-proposals-due-today/">Reminder: Summer of Haskell Proposals Due&nbsp;Today</a>
						</li>
					<li>
				<a href="https://cdsmith.wordpress.com/2016/05/01/codeworldsummer-of-haskell-update/">CodeWorld/Summer of Haskell&nbsp;Update</a>
						</li>
					<li>
				<a href="https://cdsmith.wordpress.com/2016/04/25/codeworld-summer-of-haskell-2016/">CodeWorld &amp; Summer of Haskell&nbsp;2016</a>
						</li>
				</ul>
		</li>		<li id="archives-4" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>		<ul>
			<li><a href='https://cdsmith.wordpress.com/2016/06/'>June 2016</a></li>
	<li><a href='https://cdsmith.wordpress.com/2016/05/'>May 2016</a></li>
	<li><a href='https://cdsmith.wordpress.com/2016/04/'>April 2016</a></li>
	<li><a href='https://cdsmith.wordpress.com/2016/01/'>January 2016</a></li>
	<li><a href='https://cdsmith.wordpress.com/2014/08/'>August 2014</a></li>
	<li><a href='https://cdsmith.wordpress.com/2014/06/'>June 2014</a></li>
	<li><a href='https://cdsmith.wordpress.com/2012/11/'>November 2012</a></li>
	<li><a href='https://cdsmith.wordpress.com/2012/04/'>April 2012</a></li>
	<li><a href='https://cdsmith.wordpress.com/2012/02/'>February 2012</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/10/'>October 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/09/'>September 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/08/'>August 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/07/'>July 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/06/'>June 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/04/'>April 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/03/'>March 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/02/'>February 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2011/01/'>January 2011</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/12/'>December 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/11/'>November 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/10/'>October 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/09/'>September 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/07/'>July 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/06/'>June 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/05/'>May 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/04/'>April 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2010/03/'>March 2010</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/11/'>November 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/10/'>October 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/09/'>September 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/08/'>August 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/07/'>July 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/06/'>June 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/05/'>May 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2009/04/'>April 2009</a></li>
	<li><a href='https://cdsmith.wordpress.com/2008/06/'>June 2008</a></li>
	<li><a href='https://cdsmith.wordpress.com/2008/05/'>May 2008</a></li>
	<li><a href='https://cdsmith.wordpress.com/2008/04/'>April 2008</a></li>
	<li><a href='https://cdsmith.wordpress.com/2008/03/'>March 2008</a></li>
	<li><a href='https://cdsmith.wordpress.com/2008/01/'>January 2008</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/12/'>December 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/11/'>November 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/10/'>October 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/09/'>September 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/08/'>August 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/07/'>July 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/06/'>June 2007</a></li>
	<li><a href='https://cdsmith.wordpress.com/2007/05/'>May 2007</a></li>
		</ul>
		</li><li id="tag_cloud-2" class="widget widget_tag_cloud"><h2 class="widgettitle"></h2><div style="overflow: hidden;"><a href="https://cdsmith.wordpress.com/category/categories/" style="font-size: 107%; padding: 1px; margin: 1px;"  title="Categories (4)">Categories</a> <a href="https://cdsmith.wordpress.com/category/computer-science/" style="font-size: 132.66666666667%; padding: 1px; margin: 1px;"  title="Computer Science (15)">Computer Science</a> <a href="https://cdsmith.wordpress.com/category/education/" style="font-size: 144.33333333333%; padding: 1px; margin: 1px;"  title="Education (20)">Education</a> <a href="https://cdsmith.wordpress.com/category/gloss/" style="font-size: 132.66666666667%; padding: 1px; margin: 1px;"  title="Gloss (15)">Gloss</a> <a href="https://cdsmith.wordpress.com/category/haskell/" style="font-size: 275%; padding: 1px; margin: 1px;"  title="Haskell (76)">Haskell</a> <a href="https://cdsmith.wordpress.com/category/haskell-for-kids/" style="font-size: 144.33333333333%; padding: 1px; margin: 1px;"  title="Haskell for Kids (20)">Haskell for Kids</a> <a href="https://cdsmith.wordpress.com/category/java/" style="font-size: 100%; padding: 1px; margin: 1px;"  title="Java (1)">Java</a> <a href="https://cdsmith.wordpress.com/category/math/" style="font-size: 163%; padding: 1px; margin: 1px;"  title="Math (28)">Math</a> <a href="https://cdsmith.wordpress.com/category/programming-languages/" style="font-size: 100%; padding: 1px; margin: 1px;"  title="Programming Languages (1)">Programming Languages</a> <a href="https://cdsmith.wordpress.com/category/snap/" style="font-size: 118.66666666667%; padding: 1px; margin: 1px;"  title="Snap (9)">Snap</a> <a href="https://cdsmith.wordpress.com/category/uncategorized/" style="font-size: 179.33333333333%; padding: 1px; margin: 1px;"  title="Uncategorized (35)">Uncategorized</a> </div></li><li id="meta-4" class="widget widget_meta"><h2 class="widgettitle">Meta</h2>			<ul>
			<li><a href="https://wordpress.com/start?ref=wplogin">Register</a></li>			<li><a href="https://cdsmith.wordpress.com/wp-login.php">Log in</a></li>
			<li><a href="https://cdsmith.wordpress.com/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://cdsmith.wordpress.com/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.com/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.com</a></li>			</ul>
			</li>	</ul>
</div><!--end sidebar-->	<div id="copyright">
		<p class="attrib"><a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a> </p>
	</div><!--end copyright-->
</div><!--end wrapper-->
<!--  -->
<script type='text/javascript' src='http://0.gravatar.com/js/gprofiles.js?ver=201650y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-82401038e87257529066b9e6618d470e">
	</div>
	<div class="grofile-hash-map-1e7f8859add1bf7ddd9b5fe9000b6a68">
	</div>
	</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/cdsmith.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/cdsmith.wordpress.com\/wp-login.php?action=logout&_wpnonce=9d9731ab53","homeURL":"https:\/\/cdsmith.wordpress.com\/","postID":"67","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1479964158j'></script>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/cdsmith.wordpress.com\/2009\/04\/20\/code-for-manipulating-graphs-in-haskell\/":67};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/akismet-3.0/_inc/form.js?m=1404442431h'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"1158345","siteName":"Sententia cdsmithus","siteURL":"http:\/\/cdsmith.wordpress.com","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/void.gif' class='avatar avatar-36' height='36' width='36' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/paperpunch","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/cdsmith.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fcdsmith.wordpress.com%2F2009%2F04%2F20%2Fcode-for-manipulating-graphs-in-haskell%2F","themeURL":"","xhrURL":"https:\/\/cdsmith.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"13fd00aa36","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"5dc11e0d5e\" \/>","referer":"https:\/\/cdsmith.wordpress.com\/2009\/04\/20\/code-for-manipulating-graphs-in-haskell\/?replytocom=1058","canFollow":"1","statusMessage":"","customizeLink":"https:\/\/cdsmith.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fcdsmith.wordpress.com%2F2009%2F04%2F20%2Fcode-for-manipulating-graphs-in-haskell%2F%3Freplytocom%3D1058","postID":"67","shortlink":"http:\/\/wp.me\/p4RkZ-15","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/cdsmith.wordpress.com\/67","i18n":{"view":"View Site","follow":"Follow","following":"Following","edit":"Edit","login":"Log In","signup":"Sign Up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Paperpunch","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editFollows":"Manage Sites I Follow","editSubs":"Manage Subscriptions","viewReader":"View Site in the Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 96 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/cdsmith.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fcdsmith.wordpress.com%2F2009%2F04%2F20%2Fcode-for-manipulating-graphs-in-haskell%2F\">Log in now.<\/a>"}};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??-eJx9jEESgjAMRS9kiQ4OuHE8S20jBNu0pi3q7S0LGFes8ifv/wfvqEzgjJxhSmBxJoPx00zpAH/IFxVdGYgTOHpiglfBgqNm61DWMrFxxVZYRSZ4X4dKMLpv44l3jNpWru5awOuUUWpSYUYRWmTbb89gMgVeDFvaaceQsno4TQJp1EI8rLeObv56Ovdd2166/jj9AP8Kavg='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='https://cdsmith.wordpress.com/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	var skimlinks_pub_id = "725X584219"
	var skimlinks_sitename = "cdsmith.wordpress.com";
	</script>
	<script type="text/javascript" src="https://s.skimresources.com/js/725X1342.skimlinks.js"></script>		<iframe src='https://widgets.wp.com/likes/master.html?ver=20160429#ver=20160429' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script>
			var _comscore = _comscore || [];
			_comscore.push({
				c1: "2",
				c2: "7518284"
			});
			(function() {
				var s = document.createElement("script"),
					el = document.getElementsByTagName("script")[0];
				s.async = true;
				s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
				el.parentNode.insertBefore(s, el);
			})();
		</script>
		<noscript>
			<p class="robots-nocontent"><img src="https://sb.scorecardresearch.com/p?c1=2&amp;c2=7518284&amp;c3=&amp;c4=&amp;c5=&amp;c6=&amp;c15=&amp;cv=2.0&amp;cj=1" alt="" style="display:none;" width="1" height="1" /></p>
		</noscript><script src="http://stats.wp.com/w.js?55" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'1158345','blog_tz':'-7','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'1158345','v':'wpcom','tz':'-7','user_id':'0','post':'67','subd':'cdsmith'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRPUJGYUFhNUdZYm9TYWd2R2NSNUlQVXRtdXMsP3N1LFZDcl00WEw5QUt4JVBwRV9rR0p3eDhhQ0hxL0pSMGhTOXdsSVksbC9veVgvbVIxVjVPL3pIa2xEVj8vLjUmYXZZT3dPdnF4ZGJ+KzF1OGlyUWFHbStjP21udVV6ZkJmV3UmTkdxVmNlW1JCK1JaMXAuTy1SbWxDaFhiV2trVFIwS1p1M3QuVmpmL1tTNG1oYSxvLHpMNEhGc1lsX3hhPTF5VW9TTi56USU1flg5K3xkej9WUkhzZz89WWx0PV9wJXNzYTY='}]);
_stq.push([ 'clickTrackerInit', '1158345', '67' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>

<!-- Mirrored from cdsmith.wordpress.com/2009/04/20/code-for-manipulating-graphs-in-haskell/?replytocom=1058 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Dec 2016 21:59:04 GMT -->
</html>